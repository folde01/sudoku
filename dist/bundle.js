!function(e){var t={};function l(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,l),n.l=!0,n.exports}l.m=e,l.c=t,l.d=function(e,t,o){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},l.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(l.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)l.d(o,n,function(t){return e[t]}.bind(null,n));return o},l.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="",l(l.s=1)}([function(e,t){e.exports=class{constructor(){this.boardSize=9,this.cellDB=this.initialize(),this.regionInfo={nw:{startCellX:0,endCellX:2,startCellY:0,endCellY:2,counterpart:"se"},n:{startCellX:3,endCellX:5,startCellY:0,endCellY:2,counterpart:"s"},ne:{startCellX:6,endCellX:8,startCellY:0,endCellY:2,counterpart:"sw"},w:{startCellX:0,endCellX:2,startCellY:3,endCellY:5,counterpart:"e"},c:{startCellX:3,endCellX:5,startCellY:3,endCellY:5,counterpart:"c"},e:{startCellX:6,endCellX:8,startCellY:3,endCellY:5,counterpart:"w"},sw:{startCellX:0,endCellX:2,startCellY:6,endCellY:8,counterpart:"ne"},s:{startCellX:3,endCellX:5,startCellY:6,endCellY:8,counterpart:"n"},se:{startCellX:6,endCellX:8,startCellY:6,endCellY:8,counterpart:"nw"}},this.cellValueCounts=new Array(this.boardSize+1).fill(0),this.countCompleteCellValues=0,this.filledCellCount=0}initialize(){const e=this.boardSize;let t=new Array(e);for(let l=0;l<e;l++){t[l]=new Array(e);for(let o=0;o<e;o++)t[l][o]={cellValue:0,conflicting:!1,isClue:!0,solutionValue:null,eventListener:{event:null,fn:null}}}return t}getFilledCellCount(){return this.filledCellCount}setCellValue(e,t,l){const o=this.getCellValue(e,t);this.cellDB[t][e].cellValue=l,0===o&&l>0?this.filledCellCount++:o>0&&0===l&&this.filledCellCount--}getCellValue(e,t){return this.cellDB[t][e].cellValue}getRowValues(e){return this.cellDB[e].map(e=>e.cellValue)}getColumnValues(e){let t=[];for(let l=0;l<this.boardSize;l++)t.push(this.cellDB[l][e].cellValue);return t}getRegionValues(e){let t=[];const l=this.regionInfo[e];for(let e=l.startCellX;e<=l.endCellX;e++)for(let o=l.startCellY;o<=l.endCellY;o++)t.push(this.getCellValue(e,o));return t}setCellEventListener(e,t,l,o){this.cellDB[t][e].eventListener.event=l,this.cellDB[t][e].eventListener.fn=o}getCellEventListener(e,t){return this.cellDB[t][e].eventListener}setCellClueStatus(e,t,l){this.cellDB[t][e].isClue=l}getCellClueStatus(e,t){return this.cellDB[t][e].isClue}getCellSolutionValue(e,t){return this.cellDB[t][e].solutionValue}setCellSolutionValue(e,t,l){this.cellDB[t][e].solutionValue=l}removeCellSolutionValue(e,t){this.cellDB[t][e].solutionValue=null}cellIsEmpty(e,t){return 0===this.getCellValue(e,t)}getCurrentBoardValues(){return[].concat.apply([],this.cellDB.map(e=>e.cellValue))}getConflictStatus(e,t){return this.cellDB[t][e].conflicting}setConflictStatus(e,t,l){this.cellDB[t][e].conflicting=l}columnContainsCellValue(e,t){for(let l=0;l<this.boardSize;l++)if(t===this.getCellValue(e,l))return!0;return!1}getEmptyCellsInColumn(e){let t=[];for(let l=0;l<this.boardSize;l++)this.cellIsEmpty(e,l)&&t.push(l);return t}getRegionInfo(){return this.regionInfo}getCellValueCount(e){return this.cellValueCounts[e]}incrementCellValueCount(e){this.cellValueCounts[e]++,this.cellValueCounts[e]===this.boardSize&&this.countCompleteCellValues++}decrementCellValueCount(e){this.cellValueCounts[e]===this.boardSize&&this.countCompleteCellValues--,this.cellValueCounts[e]--}getCompleteCellValueCount(){return this.countCompleteCellValues}}},function(e,t,l){const o=l(2),n=l(5),i=(console.log,new n);let s;window.addEventListener("click",function(e){e.target.classList.contains("newGame")&&(s=new o(i)).play()}),(s=new o(i)).play()},function(e,t,l){const o=l(0),n=l(3);console.log;e.exports=class{constructor(e){this.boardSize=9,this.numCells=this.boardSize*this.boardSize,this.reset(),this.domCache=e.getDomCache(),this.activeCellIndex=null,this.board=e}getConflictingCellIndex(){return this.board.getConflictingCellIndex()}setConflictingCellIndex(e){this.board.setConflictingCellIndex(e)}reset(){this.cellDB=new o,this.regionInfo=this.cellDB.getRegionInfo()}playInCell(e,t,l){this.cellDB.setCellValue(e,t,0),this.cellDB.setCellValue(e,t,l),this.cellDB.incrementCellValueCount(l)}getRegionCorners(e,t){const l=3*Math.floor(t/3),o=l+2,n=3*Math.floor(e/3);return{startRow:l,endRow:o,startColumn:n,endColumn:n+2}}getDomCell(e,t){const l=this.boardSize,o="#cell"+e+t;if(isNaN(e)||isNaN(t)||e>l-1||e<0||t>l-1||t<0)throw"getDomCell: unexpected cell coordinate. (cellX, cellY): "+e+", "+t;return this.domCache.cellsXY[o]}removeConflictHighlighting(e,t){if(!0!==this.cellDB.getCellClueStatus(e,t))try{this.getDomCell(e,t).classList.remove("invalidMove"),this.setConflictingCellIndex(null)}catch(e){throw"removeConflictHighlighting caught exception: "+e}}addConflictHighlighting(e,t){if(!0!==this.cellDB.getCellClueStatus(e,t))try{this.getDomCell(e,t).classList.add("invalidMove");const l=this.getCellIndexFromCoords(e,t);this.setConflictingCellIndex(l)}catch(e){throw"addConflictHighlighting caught exception: "+e}}userHasSolvedPuzzle(){const e=this.boardSize;if(this.cellDB.getFilledCellCount()!==e*e)return!1;for(let t=0;t<e;t++){const l=new Set(this.cellDB.getRowValues(t)),o=new Set(this.cellDB.getColumnValues(t));if(l.size!==e||o.size!==e)return!1}for(let t in this.regionInfo)if(this.regionInfo.hasOwnProperty(t)&&new Set(this.cellDB.getRegionValues(t)).size!==e)return!1;return!0}doGameOver(){this.domCache.gameOver.innerText="WOOHOO YOU WON!"}hideGameOver(){this.domCache.gameOver.innerText=""}setCellDB(e){this.cellDB=e}getCellX(e){return e%this.boardSize}getCellY(e){return Math.floor(e/this.boardSize)}getDomCellByIndex(e){const t=this.getCellX(e),l=this.getCellY(e);return this.getDomCell(t,l)}play(){const e=new n;e.solve();const t=e.getCellDB();this.setCellDB(t),this.populateBoard(),this.boardSize;const l=this.domCache.cells,o=this.domCache.inputCells,i=this.domCache.inputTable;let s=this.activeCellIndex;const r=this;l.forEach(function(e,t){const n=r.getCellX(t),c=r.getCellY(t);0===r.cellDB.getCellValue(n,c)&&(e.onclick=function(){r.removeAllConflicts(),null!==s&&l[s].classList.remove("activeCell"),l[s=t].classList.add("activeCell"),i.classList.add("inputTableActive"),o.forEach(function(t,l){let o,i=t.innerText;isNaN(i)?(o=0,i=""):o=Number(i),t.onclick=function(){r.playInCell(n,c,o),r.highlightIfConflicting(n,c,o),e.innerText=i,e.classList.remove("activeCell"),this.deactivateKeypads(),r.userHasSolvedPuzzle()&&r.doGameOver()}.bind(r)})})})}addAndStoreReferenceToEventListener(e,t,l,o,n){this.cellDB.setCellEventListener(t,l,o,n),e.addEventListener(o,n)}removeEventListenerAndStoredReference(e,t){({event:event,fn:fn}=this.cellDB.getCellEventListener(e,t)),element.removeEventListener(event,fn),this.cellDB.setCellEventListener(e,t,null)}deactivateKeypads(){this.domCache.inputTable.classList.remove("inputTableActive"),this.domCache.inputCells.forEach(function(e,t){e.onclick=null})}highlightIfConflicting(e,t,l){let o=!1;const n=this.boardSize;for(let i=0;i<n;i++)if(i!==e&&this.cellDB.getCellValue(i,t)===l){o=!0;break}if(o)return void this.setBoardConflict(e,t,!0);for(let i=0;i<n;i++)if(i!==t&&this.cellDB.getCellValue(e,i)===l){o=!0;break}if(o)return void this.setBoardConflict(e,t,!0);const i=this.getRegionCorners(e,t);for(let n=i.startColumn;n<=i.endColumn&&!o;n++)for(let s=i.startRow;s<i.endRow;s++)if((n!==e||s!==t)&&this.cellDB.getCellValue(n,s)===l){o=!0;break}o&&this.setBoardConflict(e,t,!0)}removeAllConflicts(){for(let e=0;e<this.boardSize;e++)for(let t=0;t<this.boardSize;t++)this.setBoardConflict(t,e,!1)}setBoardConflict(e,t,l){if(this.cellDB.getConflictStatus(e,t)!==l)if(this.cellDB.setConflictStatus(e,t,l),this.getDomCell(e,t),!0===l)try{this.addConflictHighlighting(e,t)}catch(e){throw"setConflictStatus caught exception: "+e}else this.removeConflictHighlighting(e,t)}getCellIndexFromCoords(e,t){return this.boardSize*t+e}addCheckerBoard(){["n","s","e","w"].forEach(function(e,t){const l=this.regionInfo[e];for(let e=l.startCellX;e<=l.endCellX;e++)for(let t=l.startCellY;t<=l.endCellY;t++)this.getDomCell(e,t).classList.add("checkerboardRegionCell")}.bind(this))}clearBoard(){this.hideGameOver(),this.deactivateKeypads(),this.clearCells(),this.addCheckerBoard()}clearCells(){this.domCache.cells.forEach(function(e){e.classList.remove("clueCell"),e.classList.remove("activeCell"),e.classList.remove("invalidMove"),e.onclick=null})}populateBoard(){this.clearBoard();const e=this.domCache.cells,t=(this.domCache.rows,this);this.boardSize,e.forEach(function(e,l){const o=this.getCellX(l),n=this.getCellY(l),i=t.cellDB.getCellValue(o,n);let s=null;0===i?s="":(s=i.toString(),e.classList.add("clueCell")),e.innerText=s}.bind(this))}}},function(e,t,l){const o=l(0),n=l(4);e.exports=class{constructor(){Array.prototype.diff=function(e){return this.filter(function(t){return e.indexOf(t)<0})},this.boardSize=9,this.cellDB=new o,this.regionInfo=this.cellDB.getRegionInfo(),this.validMoveCount=0,this.moveAttempts=0,this.moves=[]}tryMove(e){return this.moveAttempts++,!(!this.cellDB.cellIsEmpty(e.cellX,e.cellY)||!this.moveIsValid(e)||(this.cellDB.setCellValue(e.cellX,e.cellY,e.cellValue),this.cellDB.setCellSolutionValue(e.cellX,e.cellY,e.cellValue),this.validMoveCount++,this.moves.push(e),this.cellDB.incrementCellValueCount(e.cellValue),0))}undoLastMove(){if(this.moves.length>0){const e=this.moves.pop();return e.deadEnd=!0,this.cellDB.setCellValue(e.cellX,e.cellY,0),this.cellDB.removeCellSolutionValue(e.cellX,e.cellY),this.cellDB.decrementCellValueCount(e.cellValue),e.getPreviousMove().deadEndNextMoves.push(e),e}}makeMoves(e){const t=this;e.forEach(function(e,l){t.tryMove(e)})}getMoves(){return this.moves}getCellDB(){return this.cellDB}randomInt(e,t){const l=Math.ceil(e),o=Math.floor(t);return Math.floor(Math.random()*(o-l+1))+l}solve(){this.solveByPickingRandomPossibleNextMove(),this.removeCluesFromSolvedBoard()}getPossibleNextMoves(e){let t=[];for(let l=0;l<this.boardSize;l++)l!=e.cellY&&t.push(l);let l=e.cellValue;if(this.cellDB.getCellValueCount(l)===this.boardSize&&(++l,this.cellDB.getCellValueCount(l)===this.boardSize))throw"Unexpected cell value count. Terminating.";const o=e.deadEndNextMoves.map(e=>e.cellY);let i=(e.cellX+1)%this.boardSize;return t.diff(o).map(e=>new n(i,e,l))}getLastMove(){return 0===this.moves.length?null:this.moves[this.moves.length-1]}puzzleIsComplete(){return this.cellDB.getCompleteCellValueCount()===this.boardSize}solveByPickingRandomPossibleNextMove(){let e=this.getLastMove(),t=null;for(t=e?e.cellValue:1;this.cellDB.getCellValueCount(t)<this.boardSize&&!this.puzzleIsComplete();){(e=this.getLastMove())||(e=new n(-1,-1,t));let l=this.getPossibleNextMoves(e),o=!1;for(;!o;){0===l.length&&(this.undoLastMove(),e=this.getLastMove(),l=this.getPossibleNextMoves(e));const n=this.pickRandomElementFromArray(l);(o=this.tryMove(n))?(n.setPreviousMove(e),t<this.boardSize&&t++):l.splice(l.indexOf(n),1)}}}pickRandomElementFromArray(e){return e[Math.floor(Math.random()*e.length)]}removeClue(e,t){return 0!==this.cellDB.getCellValue(e,t)&&(this.cellDB.setCellValue(e,t,0),this.cellDB.setCellClueStatus(e,t,!1),!0)}removeCluesFromSolvedBoard(e){let t;(t="dev"===e?this.removeOneClueFromSolvedBoard:this.removeCluesFromSolvedBoardMediumDifficulty).call(this)}removeOneClueFromSolvedBoard(){this.removeClue(0,0)}removeCluesFromSolvedBoardMediumDifficulty(){let e=this.boardSize*this.boardSize;const t=this.removeValuesFromCenterRegion(),l=this.boardSize-t,o=(e-=t)%2==0?35:34,n=(Math.floor((o-l)/2),["nw","w","sw","s"]);let i={nw:0,w:0,sw:0,s:0};const s=this;for(n.forEach(function(e){s.removeRandomClueFromRegionAndItsCounterpart(e),i[e]++}),e-=2*n.length;e>o;){const t=n[Math.floor(Math.random()*n.length)];i[t]<this.boardSize-1&&(this.removeRandomClueFromRegionAndItsCounterpart(t),i[t]++,e-=2)}}rotate(e){let t=-1;switch(e){case 0:t=2;break;case 1:t=1;break;case 2:t=0}return t}removeRandomClueFromRegionAndItsCounterpart(e){const t=this;let l=new Set,o=!1;for(;!o&&l.size<this.boardSize;){const n=this.regionInfo[e],i=n.startCellX,s=n.endCellX,r=n.startCellY,c=n.endCellY,a=n.counterpart,u=this.randomInt(i,s),h=this.randomInt(r,c);l.add(u.toString()+h.toString()),o=t.removeClue(u,h);const d=this.regionInfo[a],C=d.startCellX,m=(d.endCellX,d.startCellY),f=(d.endCellY,this.rotate(u%3)+C),g=this.rotate(h%3)+m;t.removeClue(f,g)}return o}removeValuesFromCenterRegion(){let e={"nw-se":[{cellX:3,cellY:3},{cellX:5,cellY:5}],"sw-ne":[{cellX:3,cellY:5},{cellX:5,cellY:3}],"e-w":[{cellX:3,cellY:4},{cellX:5,cellY:4}],"n-s":[{cellX:4,cellY:3},{cellX:4,cellY:5}],c:[{cellX:4,cellY:4}]};const t=Object.keys(e);let l=[],o=!0,n=!0;for(let e=0;e<t.length;e++){const t=Math.random()>=.5;l[e]=t,t?n=!1:o=!1}if(n||o){const e=this.randomInt(0,t.length-1);l[e]=!l[e]}const i=this;let s=0;for(let o=0;o<t.length;o++){const n=l[o],r=t[o];n&&e[r].forEach(function(e,t){i.removeClue(e.cellX,e.cellY),++s})}return s}solveByPickingRandomEmptyCellFromColumn(){for(;!this.puzzleIsComplete();){let e=null,t=null;for(let l=this.moves.slice(-1)[0].cellValue;l<=this.boardSize;l++)if(e&&(l=e,e=null),t||(t=this.cellDB.getCellValueCount(l)),t!==this.boardSize){for(let e=0;e<this.boardSize;e++){if(this.cellDB.columnContainsCellValue(e,l))continue;const t=board.cellDB.getEmptyCellsInColumn(e);let o=!0;for(;o&&t.length>0;){const i=t[Math.floor(Math.random()*t.length)],s=t.indexOf(i);t.splice(t.indexOf(s),1);const r=new n(e,i,l);this.tryMove(r)&&(o=!1)}}this.cellDB.getCellValueCount(l)<=t&&(this.undoLastMove(),e=l)}}}rowIsValid(e){let t=!0;for(let l=0;l<this.boardSize;l++)0!==this.cellDB.getCellValue(l,e.cellY)&&this.cellDB.getCellValue(l,e.cellY)===e.cellValue&&(t=!1);return t}columnIsValid(e){let t=!0;for(let l=0;l<this.boardSize;l++)0!==this.cellDB.getCellValue(e.cellX,l)&&this.cellDB.getCellValue(e.cellX,l)===e.cellValue&&(t=!1);return t}regionIsValid(e){let t=!0;const l=3*Math.floor(e.cellY/3),o=l+2,n=3*Math.floor(e.cellX/3),i=n+2;for(let s=l;s<=o;s++)for(let l=n;l<=i;l++)0!==this.cellDB.getCellValue(l,s)&&this.cellDB.getCellValue(l,s)===e.cellValue&&(t=!1);return t}moveIsValid(e){return this.rowIsValid(e)&&this.columnIsValid(e)&&this.regionIsValid(e)}}},function(e,t){e.exports=class{constructor(e,t,l,o){this.previousMove=null,this.isDeadEnd=!1,this.deadEndNextMoves=[],arguments.length<3?(this.cellX=this._getRandomInt(0,boardSize-1),this.cellY=this._getRandomInt(0,boardSize-1),this.cellValue=this._getRandomInt(1,boardSize)):arguments.length>=3&&(this.cellX=e,this.cellY=t,this.cellValue=l),4===arguments.length&&(this.previousMove=o)}setPreviousMove(e){this.previousMove=e}getPreviousMove(){return this.previousMove}_getRandomInt(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}}},function(e,t){console.log;e.exports=class{constructor(){this.boardSize=9,this.domCache={logo:document.querySelector("#logo"),board:document.querySelector("#board"),inputTable:document.querySelector(".inputTable"),inputCells:document.querySelectorAll(".inputCell"),newGameButton:document.querySelector(".newGame"),rows:document.querySelectorAll(".row"),gameOver:document.querySelector(".gameOver")},this.domCache.cellsXY=this.draw(),this.domCache.cells=document.querySelectorAll(".cell"),this.conflictingCellIndex={index:null}}getConflictingCellIndex(){return this.conflictingCellIndex.index}setConflictingCellIndex(e){this.conflictingCellIndex.index=e}draw(){const e=this.domCache,t=this.boardSize,l={},o=document.createElement("ul");o.setAttribute("id","logo");const n="WHOODOKU!".split("");for(let e=0;e<9;e++){const t=document.createElement("li");t.innerText=n[e],o.appendChild(t)}const i=document.createElement("li");i.innerText="New game",i.setAttribute("class","newGame"),o.appendChild(i);const s=e.logo;s.parentNode.replaceChild(o,s);const r=e.board,c=document.createElement("table");c.setAttribute("id","board");for(let e=0;e<t;e++){const o=document.createElement("tr");o.setAttribute("class","row"),c.appendChild(o);for(let n=0;n<t;n++){const t=document.createElement("td");t.setAttribute("class","cell");const i="cell"+n+e;t.setAttribute("id",i),l["#"+i]=t,o.appendChild(t)}}r.parentNode.replaceChild(c,r);const a=document.createElement("ul");a.setAttribute("class","inputTable");for(let e=0;e<t;e++){const t=document.createElement("li");t.innerText=(e+1).toString(),t.setAttribute("class","inputCell"),a.appendChild(t)}const u=document.createElement("li");u.setAttribute("id","eraseBtn"),u.setAttribute("class","inputCell"),u.innerText="Erase",a.appendChild(u);const h=e.inputTable;return h.parentNode.replaceChild(a,h),e.inputCells=document.querySelectorAll(".inputCell"),e.inputTable=a,l}getDomCache(){return this.domCache}}}]);